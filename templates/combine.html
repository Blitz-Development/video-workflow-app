{% extends "base.html" %}

{% block title %}Combine Videos{% endblock %}

{% block content %}
<div class="combine-container">
    <h2>Combine All Videos</h2>
    
    <div class="status-section">
        <p><strong>Total videos uploaded:</strong> {{ session.uploaded_videos|length }} / {{ session.num_clips }}</p>
        
        {% if is_combined %}
            <div class="alert alert-success">
                ✓ Videos have been combined successfully!
            </div>
        {% else %}
            <div class="alert alert-info">
                All videos have been uploaded. Click the button below to combine them into a single video.
            </div>
        {% endif %}
    </div>
    
    <div class="actions">
        {% if not is_combined %}
            <form method="POST" action="{{ url_for('generate_final', session_id=session.session_id) }}">
                <button type="submit" class="btn btn-primary btn-large">
                    Combine All Videos
                </button>
            </form>
        {% else %}
            <a href="{{ url_for('download', session_id=session.session_id) }}" 
               class="btn btn-primary btn-large">
                Download Final Video
            </a>
        {% endif %}
    </div>
    
    {% if is_combined %}
        <div class="video-info">
            <p>Final video saved as: <code>{{ final_output.name }}</code></p>
            <p>You can download it using the button above.</p>
        </div>
    {% endif %}
    
    <div class="back-link">
        <a href="{{ url_for('plan', session_id=session.session_id) }}">← Back to Plan</a>
    </div>
</div>
{% endblock %}

